user  nginx;
        worker_processes  auto;

        error_log  /var/log/nginx/error.log warn;
        pid        /var/run/nginx.pid;


        events {
        worker_connections  1024;
}


        http {
        include       /etc/nginx/mime.types;
                default_type  application/octet-stream;

        log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
        '$status $body_bytes_sent "$http_referer" '
        '"$http_user_agent" "$http_x_forwarded_for"';

        access_log  /var/log/nginx/access.log  main;

        sendfile        on;
        #tcp_nopush     on;

        keepalive_timeout  65;

        gzip  on;

        #post body size
        client_max_body_size 100m;
        # 缓冲区代理缓冲用户端请求的最大字节数
        client_body_buffer_size    128k;

        #限制请求
        #limit_req_zone $uri zone=api_read:20m rate=50r/s;

        #按ip配置一个连接 zone
        #limit_conn_zone $binary_remote_addr zone=perip_conn:10m;

        #按server配置一个连接 zone
        limit_conn_zone $server_name zone=perserver_conn:500m;

        include /etc/nginx/conf.d/*.conf;
}

stream{
    limit_conn_zone $binary_remote_addr zone=ip_addr:10m;

    include /etc/nginx/stream.d/*.conf;
}